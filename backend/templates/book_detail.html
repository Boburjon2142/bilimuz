{% extends "base.html" %}
{% block content %}
<div class="row g-4">
    <div class="col-md-5">
        <img src="{{ book.cover_image.url if book.cover_image else 'https://via.placeholder.com/500x650?text=Rasm+yo%27q' }}" class="img-fluid rounded border" alt="{{ book.title }}">
    </div>
    <div class="col-md-7">
        <h2 class="fw-bold">{{ book.title }}</h2>
        <p class="text-muted mb-1">Muallif: {{ book.author.name }}</p>
        {% if book.book_format %}<p class="mb-1">Format: {{ book.get_book_format_display }}</p>{% endif %}
        {% if book.pages %}<p class="mb-1">Sahifa soni: {{ book.pages }}</p>{% endif %}
        <div class="display-6 fw-bold text-primary mb-3">${{ book.sale_price }}</div>
        <p class="lead">{{ book.description }}</p>

        <form method="post" action="{% url 'add_to_cart' book.id %}" class="d-flex align-items-center gap-3">
            {% csrf_token %}
            <div class="input-group" style="width: 150px;">
                <button class="btn btn-outline-secondary" type="button" onclick="changeQty(-1)">-</button>
                <input type="number" id="qty" name="quantity" class="form-control text-center" value="1" min="1">
                <button class="btn btn-outline-secondary" type="button" onclick="changeQty(1)">+</button>
            </div>
            <button class="btn btn-primary btn-lg" type="submit">Savatchaga qoâ€˜shish</button>
        </form>
    </div>
</div>
<script>
function changeQty(delta) {
    const input = document.getElementById('qty');
    let val = parseInt(input.value || '1', 10) + delta;
    if (val < 1) val = 1;
    input.value = val;
}
</script>
{% endblock %}
